<!-- macro library for forum comments -->
<!-- $Id$ -->

<metal:block define-macro="view_comments_inline"
             i18n:domain="cpsforum">
  <tal:block 
       tal:define="forum python:here.portal_discussion.getDiscussionForumFor(here);"
       tal:condition="forum">
    <h4 i18n:translate="forum_label_comments">Comments</h4>
    <table style="width:100%;" cellspacing="0" cellpadding="0"
           tal:define="comment_id request/comment_id|nothing;
                       threads forum/getThreads;">
      <tal:block condition="comment_id"
                 replace="structure 
                              python:here.post_view_snippet(post_id=comment_id, 
                                                            forum=forum,
                                                            is_reviewer=0,
                                                            comment_mode=1)"/>
      <tr tal:condition="python:len(threads)">
        <td colspan="2">
          <tal:block replace="structure 
                              python:here.forum_view_comments(
                                                    comment_id, forum)" />
        </td>
      </tr>
      <tr tal:condition="python:not len(threads)">
        <td i18n:translate="forum_no_message" class="forumempty">
          No comment associated with this document.
        </td>
      </tr>
    </table>
  </tal:block>
</metal:block>

