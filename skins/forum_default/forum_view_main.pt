<metal:html use-macro="here/content_lib/macros/master">

<metal:main fill-slot="main">
<tal:block define="post_id request/post_id|nothing;
                   doc here/getContent|here;
                   threads doc/getThreads;
                   post python:doc[post_id];
                   replies python:post and doc.getPostReplies(post_id);

                   image doc/image|nothing;
                   description doc/description|nothing;
                   portal_message request/portal_message|nothing;

                   is_reviewer python: here.portal_membership.checkPermission('Review portal content',here);
            ">
        <tal:block tal:replace="doc/title">
            Title
        </tal:block>
        
        <tal:block>
            <span tal:content="description">Description</span>
            <br/>
            <tal:block i18n:translate="L_forum valideur">Moderators</tal:block>:
            <tal:block repeat="moderator python:doc.getOfficialModerators(here)">
                <a tal:attributes="href moderator/homedir" tal:content="moderator/fullname">fullname
                </a><tal:block condition="not:repeat/moderator/end">,</tal:block>
              </tal:block>
            <table style="width:100%;" cellspacing="0" cellpadding="0">
                <tal:block condition="post_id" replace="structure python:here.post_view_snippet(post_id=post_id, threads=threads, is_reviewer=is_reviewer)" />
                <tr><td colspan="2">&nbsp;</td></tr>

                <tal:block condition="python:len(threads)">
                    <tr><td colspan="2">
                        <tal:block replace="structure python:here.forum_view_threads(post_id=post_id, threads=threads, is_reviewer=is_reviewer)" />
                    </td></tr>
                </tal:block>
                <tr tal:condition="python:not len(threads)">
                    <td i18n:translate="L_forum no_message" class="forumempty">
                        Aucun message dans ce forum !
                    </td>
                </tr>
            </table>
        </tal:block>
            
</tal:block>
</metal:main>
</metal:html>
